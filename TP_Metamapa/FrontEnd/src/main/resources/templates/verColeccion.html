<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout/base :: head (title=${coleccion.titulo})}"></head>

<body class="bg-primary-100 dark:bg-gray-900 flex flex-col min-h-screen transition-colors duration-300">

    <div th:replace="~{layout/base :: header}"></div>

    <main class="container mx-auto px-4 py-8 flex-grow">

        <div th:if="${successMessage}" class="alert alert-success mb-6" role="alert">
            <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
            </svg>
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-error mb-6" role="alert">
            <svg class="w-5 h-5 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
            </svg>
            <span th:text="${errorMessage}"></span>
        </div>

        <div class="space-y-8">
            <div>
                <a th:href="@{/admin(tab='collections')}"
                    class="inline-flex items-center gap-2 text-sm text-primary-600 dark:text-primary-400 hover:text-primary-700 font-medium transition-colors">
                    <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                        stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                    </svg>
                    Volver a Gestionar Colecciones
                </a>
                <h1 class="text-4xl font-bold text-primary-900 dark:text-primary-300 mt-2"
                    th:text="${coleccion.titulo}">Título de la Colección</h1>
                <p class="text-lg text-gray-600 dark:text-gray-400 mt-1" th:text="${coleccion.descripcion}">Descripción
                    de la colección.</p>
            </div>

            <div class="card p-6">
                <h3
                    class="text-xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 dark:from-primary-400 dark:to-primary-600 bg-clip-text text-transparent">
                    Detalles de la Colección</h3>
                <div class="mt-4 text-sm space-y-2">
                    <p>
                        <span class="font-semibold">Criterio de Consenso:</span>
                        <span th:switch="${coleccion.consenso}">
                            <span th:case="'MAYORIA_SIMPLE'">Mayoría simple</span>
                            <span th:case="'ABSOLUTA'">Absoluta</span>
                            <span th:case="'MULTIPLES_MENCIONES'">Múltiples menciones</span>
                            <span th:case="*">Mayoría simple</span>
                        </span>
                    </p>

                    <div th:if="${coleccion.criterio != null}">
                        <p class="font-semibold mt-4 dark:text-gray-200">Criterios de Pertenencia:</p>
                        <ul class="list-disc list-inside pl-4 text-gray-700 dark:text-gray-100 space-y-1">
                            <li th:if="${coleccion.criterio.titulo != null and !coleccion.criterio.titulo.isEmpty()}">
                                <strong>Título:</strong> <span th:text="${coleccion.criterio.titulo}"></span>
                            </li>
                            <li
                                th:if="${coleccion.criterio.categoria != null and !coleccion.criterio.categoria.isEmpty()}">
                                <strong>Categoría:</strong> <span th:text="${coleccion.criterio.categoria}"></span>
                            </li>
                            <li th:if="${coleccion.criterio.pais != null and !coleccion.criterio.pais.isEmpty()}">
                                <strong>País:</strong> <span th:text="${coleccion.criterio.pais}"></span>
                            </li>
                            <li
                                th:if="${coleccion.criterio.provincia != null and !coleccion.criterio.provincia.isEmpty()}">
                                <strong>Provincia:</strong> <span th:text="${coleccion.criterio.provincia}"></span>
                            </li>
                            <li
                                th:if="${coleccion.criterio.localidad != null and !coleccion.criterio.localidad.isEmpty()}">
                                <strong>Localidad:</strong> <span th:text="${coleccion.criterio.localidad}"></span>
                            </li>
                            <li
                                th:if="${coleccion.criterio.origen_carga != null and !coleccion.criterio.origen_carga.isEmpty()}">
                                <strong>Origen de Carga:</strong>
                                <span th:switch="${coleccion.criterio.origen_carga}">
                                    <span th:case="'FUENTE_DINAMICA'">Usuario</span>
                                    <span th:case="'FUENTE_ESTATICA'">Archivo ONG</span>
                                    <span th:case="'FUENTE_PROXY'">Servicio Externo</span>
                                    <span th:case="*">Desconocido</span>
                                </span>
                            </li>
                            <li th:if="${coleccion.criterio.contenido_multimedia != null}">
                                <strong>Tiene Multimedia:</strong> <span
                                    th:text="${coleccion.criterio.contenido_multimedia ? 'Sí' : 'No'}"></span>
                            </li>
                            <li th:if="${coleccion.criterio.fechaAcontecimientoDesde != null}">
                                <strong>Fecha de Acontecimiento desde:</strong> <span
                                    th:text="${#temporals.format(coleccion.criterio.fechaAcontecimientoDesde, 'dd/MM/yyyy')}"></span>
                            </li>
                            <li th:if="${coleccion.criterio.fechaAcontecimientoHasta != null}">
                                <strong>Fecha de Acontecimiento hasta:</strong> <span
                                    th:text="${#temporals.format(coleccion.criterio.fechaAcontecimientoHasta, 'dd/MM/yyyy')}"></span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="mt-8">
                    <h2
                        class="text-2xl font-bold bg-gradient-to-r from-primary-600 to-primary-800 dark:from-primary-400 dark:to-primary-600 bg-clip-text text-transparent">
                        Hechos en esta Colección
                        (<span th:text="${coleccion.hechos.size()}">0</span>)</h2>
                    <div class="space-y-4">
                        <div th:if="${coleccion.hechos.isEmpty()}" class="text-center text-gray-500 py-8">
                            <p>No hay hechos que coincidan con los criterios de esta colección.</p>
                        </div>
                        <div th:if="${!coleccion.hechos.isEmpty()}" th:each="hecho : ${coleccion.hechos}">
                            <div
                                th:replace="~{fragments/hechoCard :: hechoCard(hecho=${hecho}, showOptions=false, showAdminActions = true, coleccionId=${coleccion.coleccionId})}">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div>
            </div>
        </div>
    </main>

    <div th:replace="~{layout/base :: footer}"></div>
    <div th:replace="~{layout/base :: scripts}"></div>

    <script th:inline="javascript">
        var successMessage = /*[[${successMessage}]]*/ '';
        var errorMessage = /*[[${errorMessage}]]*/ '';

        if (successMessage) {
            Swal.fire({
                icon: 'success',
                title: '¡Éxito!',
                text: successMessage,
                confirmButtonColor: '#4A8DC5'
            });
        }

        if (errorMessage) {
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: errorMessage,
                confirmButtonColor: '#4A8DC5'
            });
        }
    </script>
</body>

</html>